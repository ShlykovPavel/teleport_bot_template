# Template External API Service - –ò—Ç–æ–≥–æ–≤–∞—è —Å–≤–æ–¥–∫–∞

## ‚úÖ –ß—Ç–æ —Å–æ–∑–¥–∞–Ω–æ

### üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
template-external-api-service/
‚îú‚îÄ‚îÄ .github/
‚îÇ   ‚îî‚îÄ‚îÄ copilot-instructions.md      # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–ª—è GitHub Copilot
‚îú‚îÄ‚îÄ .gitignore                        # Git ignore —Ñ–∞–π–ª
‚îú‚îÄ‚îÄ cmd/
‚îÇ   ‚îî‚îÄ‚îÄ template-service/
‚îÇ       ‚îî‚îÄ‚îÄ main.go                   # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ internal/
‚îÇ   ‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ app.go                    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ client/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ http_client.go            # HTTP –∫–ª–∏–µ–Ω—Ç —Å JWT
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ response.go               # –ü–∞—Ä—Å–∏–Ω–≥ –æ—Ç–≤–µ—Ç–æ–≤
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ external_api_service/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ external_api_service.go
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ models/
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ get_account_info_dto.go
‚îÇ   ‚îÇ           ‚îî‚îÄ‚îÄ get_demand_info_dto.go
‚îÇ   ‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ config.go                 # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ server/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ middlewares/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ middlewares.go        # Metrics, CORS middleware
‚îÇ   ‚îú‚îÄ‚îÄ services/                     # TODO: –í–∞—à–∏ —Å–µ—Ä–≤–∏—Å—ã
‚îÇ   ‚îî‚îÄ‚îÄ storage/
‚îÇ       ‚îî‚îÄ‚îÄ database/
‚îÇ           ‚îú‚îÄ‚îÄ db.go                 # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ MongoDB
‚îÇ           ‚îú‚îÄ‚îÄ db_errors/
‚îÇ           ‚îÇ   ‚îî‚îÄ‚îÄ db_errors.go      # –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –ë–î
‚îÇ           ‚îî‚îÄ‚îÄ repositories/
‚îÇ               ‚îî‚îÄ‚îÄ example_repository.go  # –ü—Ä–∏–º–µ—Ä —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
‚îú‚îÄ‚îÄ metrics/
‚îÇ   ‚îî‚îÄ‚îÄ metrics.go                    # Prometheus –º–µ—Ç—Ä–∏–∫–∏
‚îú‚îÄ‚îÄ models/                           # –ü—É—Å—Ç–æ (–¥–ª—è –≤–∞—à–∏—Ö –º–æ–¥–µ–ª–µ–π)
‚îú‚îÄ‚îÄ config.yaml                       # –û—Å–Ω–æ–≤–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ secret_config.yaml                # –°–µ–∫—Ä–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (TODO)
‚îú‚îÄ‚îÄ Dockerfile                        # Docker –æ–±—Ä–∞–∑
‚îú‚îÄ‚îÄ Makefile                          # –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —Å–±–æ—Ä–∫–∏
‚îú‚îÄ‚îÄ QUICKSTART.md                     # –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
‚îî‚îÄ‚îÄ README.md                         # –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

```

## üéØ –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### ‚úÖ HTTP –∫–ª–∏–µ–Ω—Ç —Å JWT –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –∏—Å—Ç–µ—á–µ–Ω–∏–∏
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö REST –º–µ—Ç–æ–¥–æ–≤ (GET, POST, PUT, PATCH, DELETE)

### ‚úÖ External API Service
- `GetDemandInfo(ctx, demandID)` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∑–∞—è–≤–∫–∏
- `GetAccountInfo(ctx, userID)` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞
- `UpdateDemandStatus(ctx, demandID, status)` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞

### ‚úÖ Prometheus –º–µ—Ç—Ä–∏–∫–∏
- `http_requests_total` - —Å—á—ë—Ç—á–∏–∫ –∑–∞–ø—Ä–æ—Å–æ–≤
- `http_request_duration_seconds` - –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–æ–≤

### ‚úÖ Middleware
- MetricsMiddleware - —Å–±–æ—Ä –º–µ—Ç—Ä–∏–∫
- CORSMiddleware - CORS –∑–∞–≥–æ–ª–æ–≤–∫–∏
- Recovery - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞–Ω–∏–∫

### ‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- YAML —Ñ–∞–π–ª—ã (config.yaml + secret_config.yaml)
- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –ü–æ—Ä—è–¥–æ–∫ –∑–∞–≥—Ä—É–∑–∫–∏: yaml ‚Üí secret ‚Üí env

### ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- MongoDB –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
- –ü—Ä–∏–º–µ—Ä —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è —Å TODO
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ (db_errors.HandleMongoError)

### ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (slog)
- –£—Ä–æ–≤–Ω–∏: DEBUG (local/dev), INFO (prod)
- –§–æ—Ä–º–∞—Ç—ã: —Ç–µ–∫—Å—Ç (local), JSON (dev/prod)

### ‚úÖ API Endpoints (–ø—Ä–∏–º–µ—Ä—ã)
- `GET /health` - healthcheck
- `GET /metrics` - Prometheus –º–µ—Ç—Ä–∏–∫–∏
- `GET /api/v1/demands/:id` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∑–∞—è–≤–∫–∏
- `GET /api/v1/accounts/:id` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞

### ‚úÖ Docker
- Multi-stage build
- Alpine-based –æ–±—Ä–∞–∑
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä

### ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- README.md - –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- QUICKSTART.md - –±—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
- .github/copilot-instructions.md - –¥–ª—è AI –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞

## üìù TODO –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —à–∞–±–ª–æ–Ω–∞

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å–¥–µ–ª–∞—Ç—å:

1. **–ò–∑–º–µ–Ω–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ –º–æ–¥—É–ª—è**
   ```bash
   # –í go.mod
   module your-service-name
   
   # –û–±–Ω–æ–≤–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã
   find . -type f -name "*.go" -exec sed -i 's/template-external-api-service/your-service-name/g' {} +
   ```

2. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é**
   - –°–æ–∑–¥–∞—Ç—å `secret_config.yaml` —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
   - –û–±–Ω–æ–≤–∏—Ç—å `config.yaml` —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ URL

3. **–ê–∫—Ç—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å .github/copilot-instructions.md**
   - –û–ø–∏—Å–∞—Ç—å —Å–≤–æ–π –ø—Ä–æ–µ–∫—Ç
   - –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–º–µ—Ä—ã –ø–æ–¥ —Å–≤–æ—é –¥–æ–º–µ–Ω–Ω—É—é –æ–±–ª–∞—Å—Ç—å

### –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ:

4. **–î–æ–±–∞–≤–∏—Ç—å —Å–≤–æ–∏ —Å–µ—Ä–≤–∏—Å—ã** ‚Üí `internal/services/`
5. **–î–æ–±–∞–≤–∏—Ç—å —Å–≤–æ–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏** ‚Üí `internal/storage/database/repositories/`
6. **–†–∞—Å—à–∏—Ä–∏—Ç—å External API Service** ‚Üí –¥–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥—ã –¥–ª—è –≤–∞—à–µ–≥–æ API
7. **–î–æ–±–∞–≤–∏—Ç—å —Å–≤–æ–∏ endpoints** ‚Üí `internal/app/app.go`
8. **–î–æ–±–∞–≤–∏—Ç—å —Å–≤–æ–∏ middleware** ‚Üí `internal/server/middlewares/`

## üöÄ –ö–∞–∫ –Ω–∞—á–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

```bash
# 1. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —à–∞–±–ª–æ–Ω
cp -r template-external-api-service my-new-service
cd my-new-service

# 2. –ò–∑–º–µ–Ω–∏—Ç—å module name
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å go.mod –∏ –æ–±–Ω–æ–≤–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã

# 3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
# –°–æ–∑–¥–∞—Ç—å secret_config.yaml, –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å config.yaml

# 4. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
go mod tidy

# 5. –ó–∞–ø—É—Å—Ç–∏—Ç—å
make run

# 6. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
curl http://localhost:8080/health
```

## üìö –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
make build         # –°–±–æ—Ä–∫–∞
make run          # –ó–∞–ø—É—Å–∫
make test         # –¢–µ—Å—Ç—ã
make clean        # –û—á–∏—Å—Ç–∫–∞
make docker-build # Docker —Å–±–æ—Ä–∫–∞
make fmt          # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
make deps         # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

- [x] HTTP –∫–ª–∏–µ–Ω—Ç —Å JWT –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π
- [x] External API Service —Å 3 –º–µ—Ç–æ–¥–∞–º–∏
- [x] Prometheus –º–µ—Ç—Ä–∏–∫–∏
- [x] Middleware (Metrics, CORS)
- [x] MongoDB –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
- [x] –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (YAML + ENV)
- [x] –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- [x] –ü—Ä–∏–º–µ—Ä—ã endpoints
- [x] Dockerfile
- [x] Makefile
- [x] README.md
- [x] QUICKSTART.md
- [x] .github/copilot-instructions.md
- [x] .gitignore
- [x] –ö–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫

## üéâ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!

–®–∞–±–ª–æ–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—é.

